<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>View Sign-Ups</title>

<style>
body { font-family: Arial, sans-serif; padding:20px; }
table { width:100%; border-collapse:collapse; margin-top:10px; }
th, td { border:1px solid #999; padding:8px; text-align:center; }
th { background:#ddd; }
button { padding:4px 8px; }
</style>

</head>
<body>

<h2>Club Sign-Ups</h2>

<label>Filter by Club:
  <select id="filter">
    <option value="ALL">ALL</option>
    <option>Bake Club</option>
    <option>Kislap</option>
    <option>Karyo</option>
    <option>Alianti</option>
    <option>Exposure</option>
  </select>
</label>

<table>
<thead>
<tr>
  <th>ID</th>
  <th>Name</th>
  <th>Grade</th>
  <th>Club</th>
  <th>Action</th> <!-- DELETE COLUMN -->
</tr>
</thead>
<tbody id="rows"></tbody>
</table>

<p id="total"></p>

<a href="index.html">‚Üê Back</a>

<script>
const KEY = "clubSignUps";

// Load all sign-ups from localStorage
function loadData() {
  const raw = localStorage.getItem(KEY);
  return raw ? JSON.parse(raw) : [];
}

// Render table rows and total
function render() {
  const rows = document.getElementById("rows");
  const total = document.getElementById("total");
  const filter = document.getElementById("filter").value;

  const data = loadData();
  rows.innerHTML = "";

  const list = filter === "ALL" ? data : data.filter(d => d.club === filter);

  if (data.length === 0) {
    total.textContent = "No sign-ups saved.";
    return;
  }

  if (list.length === 0) {
    total.textContent = "No sign-ups for selected club.";
    return;
  }

  list.forEach((d, index) => {
    rows.innerHTML += `
      <tr>
        <td>${d.studentId}</td>
        <td>${d.name}</td>
        <td>${d.grade}</td>
        <td>${d.club}</td>
        <td><button data-index="${index}">Delete</button></td>
      </tr>`;
  });

  total.textContent = "Total Sign-Ups: " + list.length;
}

// Filter dropdown change
document.getElementById("filter").onchange = render;

// Delete button functionality
document.getElementById("rows").onclick = function(e) {
  if (e.target.tagName === "BUTTON") {
    const idx = Number(e.target.dataset.index);
    let data = loadData();
    const filter = document.getElementById("filter").value;

    // Get filtered list to find actual object
    const list = filter === "ALL" ? data : data.filter(d => d.club === filter);
    const item = list[idx];

    // Find real index in full data
    const realIndex = data.findIndex(d => d.id === item.id);

    if (realIndex !== -1) {
      data.splice(realIndex, 1); // remove item
      localStorage.setItem(KEY, JSON.stringify(data)); // save
      render(); // refresh table
    }
  }
};

// Initial render on page load
render();
</script>

</body>
</html>
